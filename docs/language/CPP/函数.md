# 函数

## Ｃ++的程序结构

组成

- 预处理指令

    - 如`#define`和`#include <filename>`等；
    - 在程序中都是以 # 开头的

- 全局声明

    - 在函数外对数据类型、函数和变量的声明和定义

- 函数

    - 包含函数首部和函数体

    

## 函数（Function）

  一个函数就是一个功能

### main 函数

  1、  一个程序文件只能有一个主函数

​    程序总是从main函数开始执行的，main函数由系统调用

​    '**由主函数调用其他函数，其他函数可以互相调用，但是不能调用main函数**'

​    主函数的作用：调用其它函数

​    主函数以外的函数大多是封装在'**类**'里的（通过类对象调用）

  2、 标准C++要求main函数必须声明为 `int `型

-  `  void main() `也能通过，无返回值的主函数

  3、  函数调用举例

```cpp
#include <iostream>
using namespace std;
void printstar(void){
    cout << "*******" << endl;
}

int main(){
    printstar();
    return 0;
}
```

说明：

  1、`void` ： `void printstar(void)`

第一个 void 表示无返回值函数

第二个 void 表示调用时'**不能**'也不必给出参数，可以省略这个 void （无参函数）

  2、所有函数都是平行的（包括main函数），相互独立

一个函数并不属于另一个函数

不能在一个函数中定义另一个函数（嵌套定义）

不能在主函数main中定义

  3、声明位置

- 若在main函数之后定义，则要'先声明'才能被main调用
- 定义位置在main之前则不用声明}



### 函数分类

1. 系统函数（库函数）   `#include <filename>`

2. 自定义函数：

- 无参函数：调用时不必给参数：   
    - 有返回值
    - 无返回值
        - 以无返回值的居多**主函数与其之间没有数据传递，一般执行固定操作**

- 有参函数：调用时必须给出参数('在主函数和被调用函数之间有数据传递')

有返回值供主函数使用

也可无返回值（`void`）



### 定义函数



  1、定义无参函数

```cpp
typename 函数名(void)  //void可以省略，该行无分号
{
    声明部分；
    执行语句；
}
```

  2、定义有参函数

```cpp
typename 函数名(形式参数表列) //函数首部，形参的类别在这里要声明
{
    声明部分；
    执行语句；
}
```



### 函数参数

形式参数'`parameter`'：定义时的变量名 ⚠️！注意是定义时的变量名

实际参数'`argument`'：调用时的参数（表达式）

说明：

- '**形参未被调用时，不占内存**',因此称为"**形式参数**"或者"**虚拟参数**"，调用时分配内存以接受实参的数据，调用结束之后形参内存释放
- 实参可以时'**常量、变量或者表达式**'(必须是确定的值)
- 函数的首部'**声明形参类型**'
- 实参与形参的类型应该'**相同或者赋值兼容**'（eg：`char `与 `int `），若不同则按照赋值规则进行转换,'**实参附给形参**'
- 实参向形参的数据传递是值传递（单向传递）
    - 调用函数时，编译系统临时给形参分配内存
    - 实参与形参上不同单元
    - 执行函数时，形参值改变，与实参无关（实参值不受影响）



### 函数的返回值

  通过函数的调用，使主函数能得到一个确定的函数值

- return 返回值

​    将被调用函数中的一个确定的值带回主函数

​    可以无返回值，可以有多个 return （执行到哪个，哪个起作用）

```cpp
return Z <=> return(Z) //可以不要括号
return(x > y ? x : y)  //可以是表达式
```

- 返回值的类型

由定义函数时的函数类型决定

若 return 的类型与函数值类型不一致，'**以函数类型为准，函数类型决定返回值类型**'

对于数值类型可以自动进行类型转换



## 函数调用

### 一般形式

```cpp
functionname([argument]) //函数名+实参表列
```

​    其中圆括号不能省略，可以没有实参表列

​    用逗号隔开多个实参

​    实参与形参的个数相等，类型匹配，按顺序一一对应传递数据

​    不同编译器对于多个实参的求值顺序不同，例如：

```cpp
func(i,++i);
```

​    若从左到右，则为 `func(3,4)`

​    若从右往左，则为 `func(3,3)`,如`VC++`和`GCC`

​      （函数参数的压栈顺序与函数的声明顺序相反？）

​    其他要求{

- 必须时已经存在的函数；
- 如果是库函数需要` #include <filename>`加头文件
- 如果是自定义函数，需要与调用它的主函数在同一个程序单位中，'若位置在主函数之后，还需要在调用前声明'



​    b、作用：

​      函数调用作为单独的语句，要求函数完成一定操作

​      函数表达式：带回一个确定时值参加表达式的计算

​      函数参数：函数调用作为另外一个函数的实参

`m = max(a, sqrt(b));`

​    

​    c、'函数声明'

​      在函数尚未定义的情况下，先将函数的有关信息通知给编译系统，以便编译正常进行

​      声明和定义不是一回事：

​          定义：对函数功能的确立，是一个完整独立的函数单位

​          声明：把函数的有关信息（名字、类型、形参及其类型、函数体等通知编译器）

​      

​      '声明中也可以不写形参名，只写形参类型'例如：

`float add(float,float);`

​      这种声明方法称为'**函数原型'(function prototype)**,作用:

​        '**根据函数原型在程序编译阶段对调用函数的合法性进行全面检查**'  

​        函数原型的一般形式为：（基本形式）

typename functioname(typename, typename, ……);

//函数类型 函数名（参数类型1，参数类型2，……）；

​        或者为了便于阅读

typename functioname(typename parameter, typename parameter,……);

// 函数类型 函数名（参数类型1 参数名1， 参数类型2 参数名2，……）；

​        编译系统不检查参数名，写成什么都无所谓

​        主要保证函数原型与函数首部写法上一致（函数类型、函数名、参数个数、参数类型、参数顺序）

​      '对函数的外部声明'：函数声明的位置可以在函数外面，在所有函数定义之前

​              如果一个函数被多个函数调用，这样可以不必在每个主调函数中重复声明，（p92）



### 函数的嵌套调用

c++不能嵌套定义函数，但是能够嵌套调用

在调用一个函数的过程中调用另一个函数



### 函数的递归调用

在调用一个函数的过程中又直接或者间接地调用该函数本身，称为函数的递归（recursive）调用

包含递归调用的函数称为递归函数